<!DOCTYPE html>
<html>
  <head>
  <title>Modern Classic Digital Settings</title>
  <link rel='stylesheet' type='text/css' href='css/slate.min.css'>
  <script src='js/slate.min.js'></script>
  <style>
  .title {
    padding: 15px 10px;
    text-transform: uppercase;
    font-family: 'PT Sans', sans-serif;
    font-size: 1.2em;
    font-weight: 500;
    color: #888888;
    text-align: center;
  }
  </style>
  </head>

  <body>
    <h1 class='title'>Modern Classic Digital Settings</h1>

    <div class='item-container'>
      <div class='item-container-content'>
        <div class='item'>
          Set options or the Modern Classic Digital watchface.
        </div>
      </div>
    </div>

    <div class='item-container'>
      <div class='item-container-header'>Appearance: shapes</div>
      <div class='item-container-content'>
        <label class='item'>
          elapsedOuterColor
          <input id='elapsedOuterColor_picker' type='text' class='item-color item-color-sunny' value='#AA0000'>
        </label>
        <label class='item'>
          elapsedOuterBackground
          <input id='elapsedOuterBackground_picker' type='text' class='item-color item-color-sunny' value='#AAAAAA'>
        </label>
        <label class='item'>
          elapsedInnerColor
          <input id='elapsedInnerColor_picker' type='text' class='item-color item-color-sunny' value='#0000FF'>
        </label>
        <label class='item'>
          elapsedInnerBackground
          <input id='elapsedInnerBackground_picker' type='text' class='item-color item-color-sunny' value='#AAAAAA'>
        </label>
        <label class='item'>
          innermostBackgroundColor
          <input id='innermostBackgroundColor_picker' type='text' class='item-color item-color-sunny' value='#0000FF'>
        </label>
        <label class='item'>
          innermostTextColor
          <input id='innermostTextColor_picker' type='text' class='item-color item-color-sunny' value='#000000'>
        </label>
        <label class='item'>
          hourHandColor
          <input id='hourHandColor_picker' type='text' class='item-color item-color-sunny' value='#AA0000'>
        </label>
        <label class='item'>
          minuteHandColor
          <input id='minuteHandColor_picker' type='text' class='item-color item-color-sunny' value='#FFFFFF'>
        </label>
      </div>
      <div class='item-container-footer'>
        Select the colors of watchface shapes.
      </div>
    </div>

    <div class='item-container'>
      <div class='item-container-header'>Appearance: text</div>
      <div class='item-container-content'>
        <label class='item'>
          complicationMonthColor
          <input id='complicationMonthColor_picker' type='text' class='item-color item-color-sunny' value='#555555'>
        </label>
        <label class='item'>
          complicationDateColor
          <input id='complicationDateColor_picker' type='text' class='item-color item-color-sunny' value='#555555'>
        </label>
        <label class='item'>
          complicationDayColor
          <input id='complicationDayColor_picker' type='text' class='item-color item-color-sunny' value='#555555'>
        </label>
        <label class='item'>
          complicationBatteryColor
          <input id='complicationBatteryColor_picker' type='text' class='item-color item-color-sunny' value='#555555'>
        </label>
        <label class='item'>
          complicationBatteryErrorColor
          <input id='complicationBatteryErrorColor_picker' type='text' class='item-color item-color-sunny' value='#AA0000'>
        </label>
      </div>
      <div class='item-container-footer'>
        Select the colors of watchface text complications.
      </div>
    </div>
    
	<div class='item-container'>
	  <div class='item-container-header'>minuteHandWidth</div>
	  <div class='item-container-content'>
	    <label class='item'>
	      <input type='range' class='item-slider' id='minuteHandWidth_slider' name='minuteHandWidth_slider' min='1' value='3' max='20'>
	      <div class='item-input-wrapper item-slider-text'>
	        <input type='text' class='item-input' id='minuteHandWidth_value' name='minuteHandWidth_value' min='1' value='3' max='20'>
	      </div>
	    </label>
	  </div>
	</div>
	
	<div class='item-container'>
	  <div class='item-container-header'>hourHandWidth</div>
	  <div class='item-container-content'>
	    <label class='item'>
	      <input type='range' class='item-slider' id='hourHandWidth_slider' name='hourHandWidth_slider' min='1' value='7' max='20'>
	      <div class='item-input-wrapper item-slider-text'>
	        <input type='text' class='item-input' id='hourHandWidth_value' name='hourHandWidth_value' min='1' value='7' max='20'>
	      </div>
	    </label>
	  </div>
	</div>
	
	<div class='item-container'>
      
      <div class='item-container-header'>Features</div>
      <div class='item-container-content'>
        <label class='item'>
          optionDateLeadingZeroSuppression
          <input id='optionDateLeadingZeroSuppression_option' type='checkbox' class='item-toggle'>
        </label>
        <label class='item'>
          optionHourLeadingZeroSuppression
          <input id='optionHourLeadingZeroSuppression_option' type='checkbox' class='item-toggle'>
        </label>
        <label class='item'>
          option12HourTime
          <input id='option12HourTime_option' type='checkbox' class='item-toggle'>
        </label>
        <label class='item'>
          optionHourHandSnap
          <input id='optionHourHandSnap_option' type='checkbox' class='item-toggle'>
        </label>
        <label class='item'>
          optionDemoMode
          <input id='optionDemoMode_option' type='checkbox' class='item-toggle'>
        </label>
        <label class='item'>
          optionHideWeekday
          <input id='optionHideWeekday_option' type='checkbox' class='item-toggle'>
        </label>
        <label class='item'>
          optionHideMonth
          <input id='optionHideMonth_option' type='checkbox' class='item-toggle'>
        </label>
        <label class='item'>
          optionHideDate
          <input id='optionHideDate_option' type='checkbox' class='item-toggle'>
        </label>
        <label class='item'>
          optionHideBattery
          <input id='optionHideBattery_option' type='checkbox' class='item-toggle'>
        </label>
        <label class='item'>
          optionHideConnectionLost
          <input id='optionHideConnectionLost_option' type='checkbox' class='item-toggle'>
        </label>
      </div>
      <div class='item-container-footer'>
        These options control the appearance and presentation of watchface complications.
      </div>
    </div>

    <div class='item-container'>
      <div class='button-container'>
        <input id='submit_button' type='button' class='item-button' value='SAVE'>
      </div>
    </div>
  </body>
  <script>

	function initSlider(slider, value)
	{
		function onSliderUpdate(event)
		{
			value.value = event.target.value;
		}
		function onSliderValueUpdate(event)
		{
			var v = parseInt(event.target.value, 10);
			if(isNaN(v))	v = 0;
			if(v < slider.min)	v = parseInt(slider.min, 10);
			if(v > slider.max)	v = parseInt(slider.max, 10);

			event.target.value = v;
			slider.value = v;
		}
		
		slider.oninput = onSliderUpdate;
		slider.onchange = onSliderUpdate;
		value.onchange = onSliderValueUpdate;
	}

	initSlider(document.getElementById("minuteHandWidth_slider"), document.getElementById("minuteHandWidth_value"));
	initSlider(document.getElementById("hourHandWidth_slider"), document.getElementById("hourHandWidth_value"));

	function getConfigData()
	{
		var elapsedOuterColor_picker = document.getElementById('elapsedOuterColor_picker');
		var elapsedOuterBackground_picker = document.getElementById('elapsedOuterBackground_picker');
		var elapsedInnerColor_picker = document.getElementById('elapsedInnerColor_picker');
		var elapsedInnerBackground_picker = document.getElementById('elapsedInnerBackground_picker');
		var innermostBackgroundColor_picker = document.getElementById('innermostBackgroundColor_picker');
		var innermostTextColor_picker = document.getElementById('innermostTextColor_picker');
		var hourHandColor_picker = document.getElementById('hourHandColor_picker');
		var minuteHandColor_picker = document.getElementById('minuteHandColor_picker');
		var complicationMonthColor_picker = document.getElementById('complicationMonthColor_picker');
		var complicationDateColor_picker = document.getElementById('complicationDateColor_picker');
		var complicationDayColor_picker = document.getElementById('complicationDayColor_picker');
		var complicationBatteryColor_picker = document.getElementById('complicationBatteryColor_picker');
		var complicationBatteryErrorColor_picker = document.getElementById('complicationBatteryErrorColor_picker');
		var minuteHandWidth_value = document.getElementById('minuteHandWidth_value');
		var hourHandWidth_value = document.getElementById('hourHandWidth_value');
		var optionDateLeadingZeroSuppression_option = document.getElementById('optionDateLeadingZeroSuppression_option');
		var optionHourLeadingZeroSuppression_option = document.getElementById('optionHourLeadingZeroSuppression_option');
		var option12HourTime_option = document.getElementById('option12HourTime_option');
		var optionHourHandSnap_option = document.getElementById('optionHourHandSnap_option');
		var optionDemoMode_option = document.getElementById('optionDemoMode_option');
		var optionHideWeekday_option = document.getElementById('optionHideWeekday_option');
		var optionHideMonth_option = document.getElementById('optionHideMonth_option');
		var optionHideDate_option = document.getElementById('optionHideDate_option');
		var optionHideBattery_option = document.getElementById('optionHideBattery_option');
		var optionHideConnectionLost_option = document.getElementById('optionHideConnectionLost_option');

		var options =
		{
			'elapsedOuterColor_picker': elapsedOuterColor_picker.value,
			'elapsedOuterBackground_picker': elapsedOuterBackground_picker.value,
			'elapsedInnerColor_picker': elapsedInnerColor_picker.value,
			'elapsedInnerBackground_picker': elapsedInnerBackground_picker.value,
			'innermostBackgroundColor_picker': innermostBackgroundColor_picker.value,
			'innermostTextColor_picker': innermostTextColor_picker.value,
			'hourHandColor_picker': hourHandColor_picker.value,
			'minuteHandColor_picker': minuteHandColor_picker.value,
			'complicationMonthColor_picker': complicationMonthColor_picker.value,
			'complicationDateColor_picker': complicationDateColor_picker.value,
			'complicationDayColor_picker': complicationDayColor_picker.value,
			'complicationBatteryColor_picker': complicationBatteryColor_picker.value,
			'complicationBatteryErrorColor_picker': complicationBatteryErrorColor_picker.value,
			'minuteHandWidth_value': minuteHandWidth_value.value,
			'hourHandWidth_value': hourHandWidth_value.value,
			'optionDateLeadingZeroSuppression_option': optionDateLeadingZeroSuppression_option.checked,
			'optionHourLeadingZeroSuppression_option': optionHourLeadingZeroSuppression_option.checked,
			'option12HourTime_option': option12HourTime_option.checked,
			'optionHourHandSnap_option': optionHourHandSnap_option.checked,
			'optionDemoMode_option': optionDemoMode_option.checked,
			'optionHideWeekday_option': optionHideWeekday_option.checked,
			'optionHideMonth_option': optionHideMonth_option.checked,
			'optionHideDate_option': optionHideDate_option.checked,
			'optionHideBattery_option': optionHideBattery_option.checked,
			'optionHideConnectionLost_option': optionHideConnectionLost_option.checked,
		};

		// Save for next launch
		localStorage['elapsedOuterColor_picker'] = options['elapsedOuterColor_picker'];
		localStorage['elapsedOuterBackground_picker'] = options['elapsedOuterBackground_picker'];
		localStorage['elapsedInnerColor_picker'] = options['elapsedInnerColor_picker'];
		localStorage['elapsedInnerBackground_picker'] = options['elapsedInnerBackground_picker'];
		localStorage['innermostBackgroundColor_picker'] = options['innermostBackgroundColor_picker'];
		localStorage['hourHandColor_picker'] = options['hourHandColor_picker'];
		localStorage['minuteHandColor_picker'] = options['minuteHandColor_picker'];
		localStorage['innermostTextColor_picker'] = options['innermostTextColor_picker'];
		localStorage['complicationMonthColor_picker'] = options['complicationMonthColor_picker'];
		localStorage['complicationDateColor_picker'] = options['complicationDateColor_picker'];
		localStorage['complicationDayColor_picker'] = options['complicationDayColor_picker'];
		localStorage['complicationBatteryColor_picker'] = options['complicationBatteryColor_picker'];
		localStorage['complicationBatteryErrorColor_picker'] = options['complicationBatteryErrorColor_picker'];
		localStorage['minuteHandWidth_value'] = options['minuteHandWidth_value'];
		localStorage['hourHandWidth_value'] = options['hourHandWidth_value'];
		localStorage['optionDateLeadingZeroSuppression_option'] = options['optionDateLeadingZeroSuppression_option'];
		localStorage['optionHourLeadingZeroSuppression_option'] = options['optionHourLeadingZeroSuppression_option'];
		localStorage['option12HourTime_option'] = options['option12HourTime_option'];
		localStorage['optionHourHandSnap_option'] = options['optionHourHandSnap_option'];
		localStorage['optionDemoMode_option'] = options['optionDemoMode_option'];
		localStorage['optionHideWeekday_option'] = options['optionHideWeekday_option'];
		localStorage['optionHideMonth_option'] = options['optionHideMonth_option'];
		localStorage['optionHideDate_option'] = options['optionHideDate_option'];
		localStorage['optionHideBattery_option'] = options['optionHideBattery_option'];
		localStorage['optionHideConnectionLost_option'] = options['optionHideConnectionLost_option'];


		console.log('Got options: ' + JSON.stringify(options));
		return options;
	}

	function getQueryParam(variable, defaultValue)
	{
		var query = location.search.substring(1);
		var vars = query.split('&');
		for (var i = 0; i < vars.length; i++)
		{
			var pair = vars[i].split('=');
			if (pair[0] === variable)
			{
				return decodeURIComponent(pair[1]);
			}
		}
		return defaultValue || false;
	}

	var submitButton = document.getElementById('submit_button');
	submitButton.addEventListener('click', function()
	{
		console.log('Submit');

		// Set the return URL depending on the runtime environment
		var return_to = getQueryParam('return_to', 'pebblejs://close#');
		document.location = return_to + encodeURIComponent(JSON.stringify(getConfigData()));
	});

	(function()
	{
		var elapsedOuterColor_picker = document.getElementById('elapsedOuterColor_picker');
		var elapsedOuterBackground_picker = document.getElementById('elapsedOuterBackground_picker');
		var elapsedInnerColor_picker = document.getElementById('elapsedInnerColor_picker');
		var elapsedInnerBackground_picker = document.getElementById('elapsedInnerBackground_picker');
		var innermostBackgroundColor_picker = document.getElementById('innermostBackgroundColor_picker');
		var innermostTextColor_picker = document.getElementById('innermostTextColor_picker');
		var hourHandColor_picker = document.getElementById('hourHandColor_picker');
		var minuteHandColor_picker = document.getElementById('minuteHandColor_picker');
		var complicationMonthColor_picker = document.getElementById('complicationMonthColor_picker');
		var complicationDateColor_picker = document.getElementById('complicationDateColor_picker');
		var complicationDayColor_picker = document.getElementById('complicationDayColor_picker');
		var complicationBatteryColor_picker = document.getElementById('complicationBatteryColor_picker');
		var complicationBatteryErrorColor_picker = document.getElementById('complicationBatteryErrorColor_picker');
		var minuteHandWidth_value = document.getElementById('minuteHandWidth_value');
		var hourHandWidth_value = document.getElementById('hourHandWidth_value');
		var minuteHandWidth_slider = document.getElementById('minuteHandWidth_slider');
		var hourHandWidth_slider = document.getElementById('hourHandWidth_slider');
		var optionDateLeadingZeroSuppression_option = document.getElementById('optionDateLeadingZeroSuppression_option');
		var optionHourLeadingZeroSuppression_option = document.getElementById('optionHourLeadingZeroSuppression_option');
		var option12HourTime_option = document.getElementById('option12HourTime_option');
		var optionHourHandSnap_option = document.getElementById('optionHourHandSnap_option');
		var optionDemoMode_option = document.getElementById('optionDemoMode_option');
		var optionHideWeekday_option = document.getElementById('optionHideWeekday_option');
		var optionHideMonth_option = document.getElementById('optionHideMonth_option');
		var optionHideDate_option = document.getElementById('optionHideDate_option');
		var optionHideBattery_option = document.getElementById('optionHideBattery_option');
		var optionHideConnectionLost_option = document.getElementById('optionHideConnectionLost_option');


		// Load any previously saved configuration, if available
		if(localStorage['elapsedOuterColor_picker'])
		{
			elapsedOuterColor_picker.value = localStorage['elapsedOuterColor_picker'];
			elapsedOuterBackground_picker.value = localStorage['elapsedOuterBackground_picker'];
			elapsedInnerColor_picker.value = localStorage['elapsedInnerColor_picker'];
			elapsedInnerBackground_picker.value = localStorage['elapsedInnerBackground_picker'];
			innermostBackgroundColor_picker.value = localStorage['innermostBackgroundColor_picker'];
			innermostTextColor_picker.value = localStorage['innermostTextColor_picker'];
			hourHandColor_picker.value = localStorage['hourHandColor_picker'];
			minuteHandColor_picker.value = localStorage['minuteHandColor_picker'];
			complicationMonthColor_picker.value = localStorage['complicationMonthColor_picker'];
			complicationDateColor_picker.value = localStorage['complicationDateColor_picker'];
			complicationDayColor_picker.value = localStorage['complicationDayColor_picker'];
			complicationBatteryColor_picker.value = localStorage['complicationBatteryColor_picker'];
			complicationBatteryErrorColor_picker.value = localStorage['complicationBatteryErrorColor_picker'];
			minuteHandWidth_value.value = localStorage['minuteHandWidth_value'];
			hourHandWidth_value.value = localStorage['hourHandWidth_value'];
			minuteHandWidth_slider.value = localStorage['minuteHandWidth_value'];
			hourHandWidth_slider.value = localStorage['hourHandWidth_value'];
			optionDateLeadingZeroSuppression_option.checked = JSON.parse(localStorage['optionDateLeadingZeroSuppression_option']);
			optionHourLeadingZeroSuppression_option.checked = JSON.parse(localStorage['optionHourLeadingZeroSuppression_option']);
			option12HourTime_option.checked = JSON.parse(localStorage['option12HourTime_option']);
			optionHourHandSnap_option.checked = JSON.parse(localStorage['optionHourHandSnap_option']);
			optionDemoMode_option.checked = JSON.parse(localStorage['optionDemoMode_option']);
			optionHideWeekday_option.checked = JSON.parse(localStorage['optionHideWeekday_option']);
			optionHideMonth_option.checked = JSON.parse(localStorage['optionHideMonth_option']);
			optionHideDate_option.checked = JSON.parse(localStorage['optionHideDate_option']);
			optionHideBattery_option.checked = JSON.parse(localStorage['optionHideBattery_option']);
			optionHideConnectionLost_option.checked = JSON.parse(localStorage['optionHideConnectionLost_option']);
		}
	})();
  </script>
</html>
